From 45746784248c468622f0bd62597a3c5cc05e53b2 Mon Sep 17 00:00:00 2001
From: Wim Taymans <wtaymans@redhat.com>
Date: Mon, 3 Oct 2022 12:00:16 +0200
Subject: [PATCH] conf: load module-x11-bell if available

Fixes !1375
---
 src/daemon/pipewire.conf.in   | 17 +++++++++--------
 src/modules/module-x11-bell.c |  2 +-
 2 files changed, 10 insertions(+), 9 deletions(-)

diff --git a/src/daemon/pipewire.conf.in b/src/daemon/pipewire.conf.in
index 748c6173f..4aa30a4f9 100644
--- a/src/daemon/pipewire.conf.in
+++ b/src/daemon/pipewire.conf.in
@@ -159,14 +159,15 @@ context.modules = [
     { name = libpipewire-module-session-manager }
 
     # Use libcanberra to play X11 Bell
-    #{ name = libpipewire-module-x11-bell
-    #  args = {
-    #      #sink.name = "@DEFAULT_SINK@"
-    #      #sample.name = "bell-window-system"
-    #      #x11.display = null
-    #      #x11.xauthority = null
-    #  }
-    #}
+    { name = libpipewire-module-x11-bell
+        args = {
+            #sink.name = "@DEFAULT_SINK@"
+            #sample.name = "bell-window-system"
+            #x11.display = null
+            #x11.xauthority = null
+        }
+        flags = [ ifexists nofail ]
+    }
 ]
 
 context.objects = [
diff --git a/src/modules/module-x11-bell.c b/src/modules/module-x11-bell.c
index b7bc2a970..cc0c2c8d5 100644
--- a/src/modules/module-x11-bell.c
+++ b/src/modules/module-x11-bell.c
@@ -109,7 +109,7 @@ static int play_sample(struct impl *impl)
 	if (sample == NULL)
 		sample = "bell-window-system";
 
-	pw_log_debug("play sample %s", sample);
+	pw_log_info("play sample %s", sample);
 
 	if ((res = ca_context_create(&ca)) < 0) {
 		pw_log_error("canberra context create error: %s", ca_strerror(res));
-- 
GitLab

